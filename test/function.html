<!DOCTYPE HTML>
<html lang="en-US">
<head>
	<meta charset="UTF-8">
	<title>Function properties Unit Tests</title>
	<script type="text/javascript" src="util/doh/runner.js"></script>
	<script type="text/javascript" src="../aop.js"></script>
	<script type="text/javascript">
		(function(global, doh, aop, undef) {
            
            var testAspect = {
                before: function() {}
            };
            
            function addAspect(target) {
                return aop.add(target, 'method', testAspect);
            }

			// Test fixture
			function Fixture() {
			}

			Fixture.prototype = {
				method: function() {}
            };

			doh.register('function', [
                function testFunctionProperties() {
                    var target = new Fixture();
                    
                    target.method.test = true;
                    addAspect(target);
                    
                    doh.assertTrue(target.method.test);
                },
                function testPrototype() {
                    var target = new Fixture();

                    target.method.prototype = {
                        method2: function() {}
                    };
                    
                    addAspect(target);
                    
                    doh.assertTrue(!!target.method.prototype.method2);
                },
                function testPrototypeInstance() {
                    var target, m1, m2;
                    
                    target = new Fixture();
                    target.method.prototype = {
                        method2: function() {}
                    };
                    
                    m1 = new target.method();

                    addAspect(target);
                    
                    m2 = new target.method();
                    
                    doh.assertEqual(m1.method2, m2.method2);
                }
			]);

			doh.run();

		})(window, doh, aop);
	</script>
</head>
<body>

</body>
</html>